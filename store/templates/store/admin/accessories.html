{% extends 'store/base.html' %}
{% load static %}
{% block title %}Accessories (Admin){% endblock %}

{% block extra_css %}
<style>
    /* Scoped dark-mode styling for admin accessories list */
    html[data-theme='dark'] .admin-accessories .card { background: var(--card-bg) !important; border: 1px solid var(--border-color) !important; }
    html[data-theme='dark'] .admin-accessories .table>:not(caption)>*>*:not(.btn):not(.badge) { background: transparent !important; box-shadow: none !important; color: #FFFFFF !important; border-color: var(--border-color) !important; }
    html[data-theme='dark'] .admin-accessories thead th { background: rgba(25,40,60,0.65) !important; color: #FFFFFF !important; font-weight: 600 !important; }
    html[data-theme='dark'] .admin-accessories tbody tr { background: rgba(20,30,45,0.55) !important; }
    html[data-theme='dark'] .admin-accessories tbody tr:nth-child(odd) { background: rgba(25,40,60,0.55) !important; }
    html[data-theme='dark'] .admin-accessories tbody tr:hover { background: rgba(40,80,140,0.55) !important; }
    .section-heading { margin-bottom: 1rem; }

    /* Dropdown / select color tweaks scoped to admin accessories */
    .admin-accessories .form-select {
        background-color: rgba(40,80,140,0.08); /* subtle blue tint */
        color: #0b1220; /* dark text on light variant */
        border-color: rgba(40,80,140,0.25);
        box-shadow: none;
        transition: box-shadow .15s ease, border-color .15s ease;
    }
    .admin-accessories .form-select:focus {
        border-color: rgba(40,80,140,0.6);
        box-shadow: 0 0 0 0.2rem rgba(40,80,140,0.12);
        outline: none;
    }

    /* Dark-theme variations */
    html[data-theme='dark'] .admin-accessories .form-select {
        background-color: rgba(40,80,140,0.12); /* slightly stronger blue tint in dark */
        color: #FFFFFF;
        border-color: rgba(255,255,255,0.06);
    }
    html[data-theme='dark'] .admin-accessories .form-select:focus {
        border-color: rgba(40,80,140,0.8);
        box-shadow: 0 0 0 0.2rem rgba(40,80,140,0.18);
    }

    /* Make option backgrounds more readable in dark mode */
    html[data-theme='dark'] .admin-accessories .form-select option {
        background: #0f1724; color: #fff;
    }
</style>
{% endblock %}

{% block content %}
<section class="section admin-accessories">
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="section-heading"><i class="fas fa-boxes me-2"></i> Accessories (Admin)</h2>
            <a href="{% url 'admin_add_accessory' %}" class="btn btn-primary"><i class="fas fa-plus me-2"></i>Add Accessory</a>
        </div>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0 text-white">Manage Accessories</h5>
                <small class="text-muted">Total: {{ accessories|length }}</small>
            </div>
            <div class="card-body">
                {% if accessories %}
                <table class="table">
                    <thead>
                        <tr>
                            <th class="admin-text-black">Image</th>
                            <th class="admin-text-black">Name</th>
                            <th class="admin-text-black">Price</th>
                            <th class="admin-text-black">Stock</th>
                            <th class="admin-text-black">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for accessory in accessories %}
                        <tr>
                            <td>
                                {% if accessory.image %}
                                    <img src="{{ accessory.image.url }}" alt="{{ accessory.name }}" class="img-fluid img-thumbnail" style="width:64px; height:auto;">
                                {% else %}
                                    <img src="{% static 'images/placeholder.png' %}" alt="No image" class="img-fluid img-thumbnail" style="width:64px; height:auto;">
                                {% endif %}
                            </td>
                            <td><strong class="admin-text-black">{{ accessory.name }}</strong></td>
                            <td class="admin-text-black">â‚¹{{ accessory.price }}</td>
                            <td class="admin-text-black">{{ accessory.stock_quantity }}</td>
                            <td>
                                <a class="btn btn-primary btn-sm" href="{% url 'admin_edit_accessory' accessory.id %}"><i class="fas fa-edit"></i></a>
                                <form method="post" action="{% url 'admin_delete_accessory' accessory.id %}" style="display:inline">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger btn-sm" data-confirm="Delete this accessory?">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="empty-state text-center py-4">
                    <i class="fas fa-boxes fa-2x mb-2"></i>
                    <h4 class="mb-1">No accessories yet</h4>
                    <p class="text-muted">Create your first accessory to show up here.</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}
